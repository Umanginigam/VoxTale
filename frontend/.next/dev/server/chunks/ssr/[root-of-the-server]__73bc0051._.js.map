{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/voice-storytelling/frontend/utils/recorder.ts"],"sourcesContent":["export async function recordAudio() {\n  const stream = await navigator.mediaDevices.getUserMedia({ audio: true })\n  const mediaRecorder = new MediaRecorder(stream)\n  const chunks: BlobPart[] = []\n\n  mediaRecorder.ondataavailable = e => chunks.push(e.data)\n  mediaRecorder.start()\n\n  return {\n    stop: () =>\n      new Promise<Blob>((resolve) => {\n        mediaRecorder.onstop = () => {\n          const blob = new Blob(chunks, { type: \"audio/webm\" })\n          resolve(blob)\n        }\n        mediaRecorder.stop()\n      })\n  }\n}\n"],"names":[],"mappings":";;;;AAAO,eAAe;IACpB,MAAM,SAAS,MAAM,UAAU,YAAY,CAAC,YAAY,CAAC;QAAE,OAAO;IAAK;IACvE,MAAM,gBAAgB,IAAI,cAAc;IACxC,MAAM,SAAqB,EAAE;IAE7B,cAAc,eAAe,GAAG,CAAA,IAAK,OAAO,IAAI,CAAC,EAAE,IAAI;IACvD,cAAc,KAAK;IAEnB,OAAO;QACL,MAAM,IACJ,IAAI,QAAc,CAAC;gBACjB,cAAc,MAAM,GAAG;oBACrB,MAAM,OAAO,IAAI,KAAK,QAAQ;wBAAE,MAAM;oBAAa;oBACnD,QAAQ;gBACV;gBACA,cAAc,IAAI;YACpB;IACJ;AACF"}},
    {"offset": {"line": 38, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/voice-storytelling/frontend/utils/upload.ts"],"sourcesContent":["export async function uploadAudio(\n  blob: Blob,\n  roomId: string,\n  userId: string\n) {\n  const formData = new FormData()\n  formData.append(\"file\", blob)\n\n  const res = await fetch(\n    `http://localhost:8000/upload-audio?room_id=${roomId}&user_id=${userId}`,\n    { method: \"POST\", body: formData }\n  )\n\n  return res.json()\n}\n"],"names":[],"mappings":";;;;AAAO,eAAe,YACpB,IAAU,EACV,MAAc,EACd,MAAc;IAEd,MAAM,WAAW,IAAI;IACrB,SAAS,MAAM,CAAC,QAAQ;IAExB,MAAM,MAAM,MAAM,MAChB,CAAC,2CAA2C,EAAE,OAAO,SAAS,EAAE,QAAQ,EACxE;QAAE,QAAQ;QAAQ,MAAM;IAAS;IAGnC,OAAO,IAAI,IAAI;AACjB"}},
    {"offset": {"line": 73, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/voice-storytelling/frontend/pages/room/%5Bid%5D.tsx"],"sourcesContent":["import { useRouter } from \"next/router\";\nimport { useEffect, useState, useRef } from \"react\";\nimport { recordAudio } from \"@/utils/recorder\"\nimport { uploadAudio } from \"@/utils/upload\"\nimport { useParams } from \"next/navigation\";\n\n\nexport default function Room() {\n  const params = useParams();\n  const id = params?.id as string;\n  const [messages, setMessages] = useState<any[]>([]);\n  const [recorder, setRecorder] = useState<any>(null);\n  const [recording, setRecording] = useState(false);\n  const wsRef = useRef<WebSocket | null>(null);\n  const userId = useRef(\n    Math.random().toString(36).slice(2, 7)\n  );\n\n  useEffect(() => {\n    if (!id) return;\n\n    const ws = new WebSocket(\n      `ws://localhost:8000/ws/${id}/${userId.current}`\n    );\n\n    ws.onmessage = (event) => {\n      setMessages((prev) => [...prev, JSON.parse(event.data)]);\n    };\n\n    wsRef.current = ws;\n\n    return () => ws.close();\n  }, [id]);\n\n  async function startRecording() {\n    const rec = await recordAudio()\n    setRecorder(rec)\n    setRecording(true)\n  }\n\n  async function stopRecording() {\n    const audioBlob = await recorder.stop()\n    setRecording(false)\n\n    const res = await uploadAudio(audioBlob, id as string, userId.current)\n\n   \n\n    console.log(\"Uploaded audio:\", res)\n  }\n\n  return (\n    <div style={{ padding: 40 }}>\n      <h2>Room: {id}</h2>\n\n      <div style={{ marginBottom: 20 }}>\n        {!recording ? (\n          <button onClick={startRecording}>Start Recording</button>\n        ) : (\n          <button onClick={stopRecording}>Stop Recording</button>\n        )}\n      </div>\n\n      <div style={{ marginBottom: 20 }}>\n        {messages.map((m, i) => {\n  if (m.event === \"AI_MESSAGE\") {\n    return (\n      <p key={i}>\n        <b style={{ color: \"purple\" }}>AI:</b> {m.turn.transcript}\n      </p>\n    );\n  }\n\n  if (m.event === \"USER_JOINED\") {\n    return (\n      <p key={i} style={{ color: \"gray\" }}>\n        User {m.user} joined room\n      </p>\n    );\n  }\n\n  return null;\n})}\n\n      </div>\n\n      <pre>{JSON.stringify(messages, null, 2)}</pre>\n    </div>\n    );\n}"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;;;;;;AAGe,SAAS;IACtB,MAAM,SAAS,IAAA,wIAAS;IACxB,MAAM,KAAK,QAAQ;IACnB,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,+GAAQ,EAAQ,EAAE;IAClD,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,+GAAQ,EAAM;IAC9C,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,+GAAQ,EAAC;IAC3C,MAAM,QAAQ,IAAA,6GAAM,EAAmB;IACvC,MAAM,SAAS,IAAA,6GAAM,EACnB,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,KAAK,CAAC,GAAG;IAGtC,IAAA,gHAAS,EAAC;QACR,IAAI,CAAC,IAAI;QAET,MAAM,KAAK,IAAI,UACb,CAAC,uBAAuB,EAAE,GAAG,CAAC,EAAE,OAAO,OAAO,EAAE;QAGlD,GAAG,SAAS,GAAG,CAAC;YACd,YAAY,CAAC,OAAS;uBAAI;oBAAM,KAAK,KAAK,CAAC,MAAM,IAAI;iBAAE;QACzD;QAEA,MAAM,OAAO,GAAG;QAEhB,OAAO,IAAM,GAAG,KAAK;IACvB,GAAG;QAAC;KAAG;IAEP,eAAe;QACb,MAAM,MAAM,MAAM,IAAA,yHAAW;QAC7B,YAAY;QACZ,aAAa;IACf;IAEA,eAAe;QACb,MAAM,YAAY,MAAM,SAAS,IAAI;QACrC,aAAa;QAEb,MAAM,MAAM,MAAM,IAAA,uHAAW,EAAC,WAAW,IAAc,OAAO,OAAO;QAIrE,QAAQ,GAAG,CAAC,mBAAmB;IACjC;IAEA,qBACE,qKAAC;QAAI,OAAO;YAAE,SAAS;QAAG;;0BACxB,qKAAC;;oBAAG;oBAAO;;;;;;;0BAEX,qKAAC;gBAAI,OAAO;oBAAE,cAAc;gBAAG;0BAC5B,CAAC,0BACA,qKAAC;oBAAO,SAAS;8BAAgB;;;;;yCAEjC,qKAAC;oBAAO,SAAS;8BAAe;;;;;;;;;;;0BAIpC,qKAAC;gBAAI,OAAO;oBAAE,cAAc;gBAAG;0BAC5B,SAAS,GAAG,CAAC,CAAC,GAAG;oBACxB,IAAI,EAAE,KAAK,KAAK,cAAc;wBAC5B,qBACE,qKAAC;;8CACC,qKAAC;oCAAE,OAAO;wCAAE,OAAO;oCAAS;8CAAG;;;;;;gCAAO;gCAAE,EAAE,IAAI,CAAC,UAAU;;2BADnD;;;;;oBAIZ;oBAEA,IAAI,EAAE,KAAK,KAAK,eAAe;wBAC7B,qBACE,qKAAC;4BAAU,OAAO;gCAAE,OAAO;4BAAO;;gCAAG;gCAC7B,EAAE,IAAI;gCAAC;;2BADP;;;;;oBAIZ;oBAEA,OAAO;gBACT;;;;;;0BAIM,qKAAC;0BAAK,KAAK,SAAS,CAAC,UAAU,MAAM;;;;;;;;;;;;AAG3C"}}]
}